local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer

local function getCharacter()
	return player.Character or player.CharacterAdded:Wait()
end

local character = getCharacter()
local humanoid = character:WaitForChild("Humanoid")
local hrp = character:WaitForChild("HumanoidRootPart")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FlyUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local flying = false
local speed = 60
local bodyVelocity
local bodyGyro

local toggle = Instance.new("TextButton")
toggle.Size = UDim2.new(0,140,0,50)
toggle.Position = UDim2.new(0.05,0,0.75,0)
toggle.Text = "FLY OFF"
toggle.BackgroundColor3 = Color3.fromRGB(200,50,50)
toggle.TextScaled = true
toggle.Parent = screenGui

local plus = Instance.new("TextButton")
plus.Size = UDim2.new(0,60,0,50)
plus.Position = UDim2.new(0.05,150,0.75,0)
plus.Text = "+"
plus.TextScaled = true
plus.Parent = screenGui

local minus = Instance.new("TextButton")
minus.Size = UDim2.new(0,60,0,50)
minus.Position = UDim2.new(0.05,220,0.75,0)
minus.Text = "-"
minus.TextScaled = true
minus.Parent = screenGui

local label = Instance.new("TextLabel")
label.Size = UDim2.new(0,200,0,40)
label.Position = UDim2.new(0.05,0,0.68,0)
label.Text = "Speed: "..speed
label.BackgroundTransparency = 0.3
label.TextScaled = true
label.Parent = screenGui

local function startFly()
	if flying then return end
	flying = true
	
	bodyVelocity = Instance.new("BodyVelocity")
	bodyVelocity.MaxForce = Vector3.new(1e5,1e5,1e5)
	bodyVelocity.Parent = hrp
	
	bodyGyro = Instance.new("BodyGyro")
	bodyGyro.MaxTorque = Vector3.new(1e5,1e5,1e5)
	bodyGyro.Parent = hrp
	
	humanoid.PlatformStand = true
	
	toggle.Text = "FLY ON"
	toggle.BackgroundColor3 = Color3.fromRGB(50,200,50)
end

local function stopFly()
	flying = false
	
	if bodyVelocity then bodyVelocity:Destroy() end
	if bodyGyro then bodyGyro:Destroy() end
	
	humanoid.PlatformStand = false
	
	toggle.Text = "FLY OFF"
	toggle.BackgroundColor3 = Color3.fromRGB(200,50,50)
end

toggle.MouseButton1Click:Connect(function()
	if flying then
		stopFly()
	else
		startFly()
	end
end)

plus.MouseButton1Click:Connect(function()
	speed = speed + 10
	label.Text = "Speed: "..speed
end)

minus.MouseButton1Click:Connect(function()
	if speed > 10 then
		speed = speed - 10
		label.Text = "Speed: "..speed
	end
end)

RunService.RenderStepped:Connect(function()
	if flying and bodyVelocity and bodyGyro then
		bodyVelocity.Velocity = workspace.CurrentCamera.CFrame.LookVector * speed
		bodyGyro.CFrame = workspace.CurrentCamera.CFrame
	end
end)
